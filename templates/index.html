<!DOCTYPE html>
<html lang="en">

<head>
    <title>MY index</title>
    <!-- 页面图标 -->
    <link rel="shortcut icon" href="{% static 'img/avater_240.jpg' %}">
    <!-- Fontawesome Icons v6.2.0 -->
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.css" rel="stylesheet">
    <!-- Roboto Font -->
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700&display=swap"
        rel="stylesheet">
    <!-- CSS File -->
    <link rel="stylesheet" href="{% static 'css/index_style.css' %}">
    <link rel="stylesheet" href="{% static 'css/test.css' %}">
    <!-- markdown-it-->
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.1/dist/markdown-it.min.js"></script>
    <!--cdn引用highlight并调用-->
    <link href="https://cdn.bootcdn.net/ajax/libs/highlight.js/11.7.0/styles/stackoverflow-dark.min.css" rel="stylesheet">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://cdn.bootcdn.net/ajax/libs/showdown/2.1.0/showdown.js"></script>

</head>

<body>
    <div class="container">
        <nav>
            <div class="brand">
                <img src="{% static 'img/avater_240.jpg' %}" alt="">
                <p>
                    Good day,
                    <span>{{ username }}!</span>
                </p>
            </div>
            <hr class="line">
            <ul class="list">
                <li class="active">
                    <i class="fa-solid fa-home"></i>
                    <span>Home</span>
                </li>
                <li>
                    <i class="fa-solid fa-list"></i>
                    <span>Category</span>
                </li>
                <li>
                    <i class="fa-solid fa-clock"></i>
                    <span>Archive</span>
                </li>
                <li>
                    <i class="fa-solid fa-user"></i>
                    <span>Accounts</span>
                </li>
                <li>
                    <i class="fa-solid fa-filter"></i>
                    <span><a href='/homepage'>Backend</a></span>
                </li>
                <hr class="line">
                <li>
                    {% if username == 'Guest' %}
                    <i class="fa-solid fa-right-to-bracket"></i>
                    <span><a href="{% url 'login' %}">Login</a></span>
                    {% else %}
                    <i class="fa-solid fa-right-from-bracket"></i>
                    <span><a href="{% url 'logout' %}">Logout</a></span>
                    {% endif %}
                </li>
            </ul>
        </nav>
        <div class="main_content">
            <div class="markdown-main">
                <div class="markdown-title">
                    {{markdown.title}}
                </div>
                <div class="markdown-author">
                    作者:{{markdown.author}} 发表时间:{{markdown.created_at}}
                </div>
                <div class="markdown-content">
                    <!-- {{ markdown.content|safe|slice:"0:" }} -->
                </div>
            </div>
            <div class="main-footer">
                {% if prev_record %}
                <a href="{% url 'index' %}?prev_record_id={{ prev_record.id }}"><button type="button" class="pre-but">上一篇</button></a>
                {% else %}
                <button type="button" class="pre-but">已经是第一篇了</button>
                {% endif %}
                {% if next_record %}
                <a href="{% url 'index' %}?next_record_id={{ next_record.id }}"><button type="button" class="nxt-but">下一篇</button></a>
                {% else %}
                <button type="button" class="nxt-but">已经是最后一篇了</button>
                {% endif %}
            </div>
        </div>
    </div>
    <!--传入markdown内容时应该直接传入到js中，传到HTML中会将>自动转为&gt-->
    <script>
        var markdownContent = document.querySelector('.markdown-content');
        var data = '{{ markdown.content|escapejs }}';
        console.log(data);
        var converter = new showdown.Converter({
            tables:true,
            metadata: true,
            strikethrough: true,
        });
        var html = converter.makeHtml(data);
        markdownContent.innerHTML = html;
    </script>
</body>

</html>